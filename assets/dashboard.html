<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู ุงูุฐููุฉ - ุงูููุตุฉ ุงูุชุนููููุฉ</title>
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- HEADER -->
        <div class="dashboard-header">
            <div class="dashboard-header-left">
                <div style="font-size: 3rem;">๐</div>
                <h1>ููุญุฉ ุงูุชุญูู ุงูุฐููุฉ</h1>
            </div>
            <div class="dashboard-actions">
                <div class="ai-indicator">
                    ๐ค ูุธุงู ุฐูู ูุดุท
                </div>
                <button class="btn btn-primary" onclick="downloadDashboardReport()">๐ฅ ุชุญููู ุงูุชูุฑูุฑ</button>
            </div>
        </div>

        <!-- NAVIGATION TABS -->
        <div class="dashboard-nav-tabs">
            <div class="dashboard-nav-tab active" onclick="switchDashboardTab(event, 'dashboard-overview')">๐ ูุธุฑุฉ ุนุงูุฉ</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-subjects')">๐ ุงูููุงุฏ</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-lessons')">๐ ุงูุฏุฑูุณ</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-videos')">๐ฌ ุงูููุฏูููุงุช</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-exercises')">โ๏ธ ุงูุชูุงุฑูู</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-students')">๐ฅ ุงูุทูุงุจ</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-subscriptions')">๐ณ ุงูุงุดุชุฑุงูุงุช</div>
            <div class="dashboard-nav-tab" onclick="switchDashboardTab(event, 'dashboard-ai')">๐ค ุฑุคู ุฐููุฉ</div>
        </div>

        <!-- TAB: OVERVIEW -->
        <div id="dashboard-overview" class="dashboard-content active">
            <div class="dashboard-stats-section">
                <h2>๐ ุงูุฅุญุตุงุฆูุงุช ุงูุฑุฆูุณูุฉ</h2>
                <div class="dashboard-stats-grid">
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-subjects">0</h3>
                        <p>ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-lessons">0</h3>
                        <p>ุงูุฏุฑูุณ</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-videos">0</h3>
                        <p>ุงูููุฏูููุงุช</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-exercises">0</h3>
                        <p>ุงูุชูุงุฑูู</p>
                    </div>
                </div>
            </div>
            <div class="dashboard-stats-section">
                <h2>๐ฅ ุฅุญุตุงุฆูุงุช ุงูุทูุงุจ</h2>
                <div class="dashboard-stats-grid">
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-students">0</h3>
                        <p>ุงูุทูุงุจ ุงููุณุฌููู</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-active-students">0</h3>
                        <p>ุทูุงุจ ูุดุทูู</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-avg-performance">0%</h3>
                        <p>ูุชูุณุท ุงูุฃุฏุงุก</p>
                    </div>
                    <div class="dashboard-stat-card">
                        <h3 id="dashboard-total-revenue">0 ุฏ.ุช</h3>
                        <p>ุงูุฅูุฑุงุฏุงุช</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB: SUBJECTS -->
        <div id="dashboard-subjects" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ</h2>
            </div>
            <div class="dashboard-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ุงููุงุฏุฉ</th>
                            <th>ุงููุณุชููุงุช</th>
                            <th>ุนุฏุฏ ุงูุฏุฑูุณ</th>
                            <th>ุงูุฐูุงุก ุงูุงุตุทูุงุนู</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-subjects-tbody">
                        <tr><td colspan="4" style="text-align:center;color:#999;">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: LESSONS -->
        <div id="dashboard-lessons" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ ุฅุฏุงุฑุฉ ุงูุฏุฑูุณ</h2>
                <button class="btn btn-success" onclick="openDashboardAddLessonModal()">โ ุฅุถุงูุฉ ุฏุฑุณ</button>
            </div>
            <div id="dashboard-lessons-list"></div>
        </div>

        <!-- TAB: VIDEOS -->
        <div id="dashboard-videos" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ฌ ุฅุฏุงุฑุฉ ุงูููุฏูููุงุช</h2>
                <button class="btn btn-success" onclick="openDashboardAddVideoModal()">โ ุฅุถุงูุฉ ููุฏูู</button>
            </div>
            <div class="dashboard-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ุงูููุฏูู</th>
                            <th>ุงูุฏุฑุณ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-videos-tbody">
                        <tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ููุฏูููุงุช</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: EXERCISES -->
        <div id="dashboard-exercises" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>โ๏ธ ุฅุฏุงุฑุฉ ุงูุชูุงุฑูู</h2>
                <button class="btn btn-success" onclick="openDashboardAddExerciseModal()">โ ุฅุถุงูุฉ ุชูุฑูู</button>
            </div>
            <div class="dashboard-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ุงูุณุคุงู</th>
                            <th>ุงูุฏุฑุณ</th>
                            <th>ุงูููุน</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-exercises-tbody">
                        <tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ุชูุงุฑูู</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: STUDENTS -->
        <div id="dashboard-students" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ฅ ุฅุฏุงุฑุฉ ุงูุทูุงุจ</h2>
                <button class="btn btn-success" onclick="openDashboardAddStudentModal()">โ ุฅุถุงูุฉ ุทุงูุจ</button>
            </div>
            <div class="dashboard-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ุงูุงุณู</th>
                            <th>ุงููุณุชูู</th>
                            <th>ุงูุฃุฏุงุก</th>
                            <th>ุงูุญุงูุฉ</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-students-tbody">
                        <tr><td colspan="4" style="text-align:center;color:#999;">ูุง ููุฌุฏ ุทูุงุจ</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: SUBSCRIPTIONS -->
        <div id="dashboard-subscriptions" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ณ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช</h2>
                <button class="btn btn-success" onclick="openDashboardAddSubscriptionModal()">โ ุฅุถุงูุฉ ุฎุทุฉ</button>
            </div>
            <div class="dashboard-table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>ุงูุฎุทุฉ</th>
                            <th>ุงูุณุนุฑ</th>
                            <th>ุงููุฏุฉ</th>
                            <th>ุงูุญุงูุฉ</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-subscriptions-tbody">
                        <tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ุฎุทุท</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: AI INSIGHTS -->
        <div id="dashboard-ai" class="dashboard-content">
            <div class="dashboard-stats-section">
                <h2>๐ค ุงูุฑุคู ูุงูุชูุตูุงุช ุงูุฐููุฉ</h2>
                <div id="dashboard-ai-content"></div>
            </div>
        </div>
    </div>

    <!-- ADD LESSON MODAL -->
    <div id="dashboardAddLessonModal" class="dashboard-modal">
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2>ุฅุถุงูุฉ ุฏุฑุณ ุฐูู</h2>
                <button class="dashboard-close-btn" onclick="closeDashboardModal('dashboardAddLessonModal')">ร</button>
            </div>
            <div class="form-group">
                <label>ุงุณู ุงูุฏุฑุณ</label>
                <input type="text" id="dashboardLessonTitle" placeholder="ุฃุฏุฎู ุงุณู ุงูุฏุฑุณ">
            </div>
            <div class="form-group">
                <label>ุงููุงุฏุฉ</label>
                <select id="dashboardLessonSubject"></select>
            </div>
            <div class="form-group">
                <label>ุงููุณุชูู</label>
                <select id="dashboardLessonLevel">
                    <option value="3">ุงูุณูุฉ 3</option>
                    <option value="4">ุงูุณูุฉ 4</option>
                    <option value="5">ุงูุณูุฉ 5</option>
                    <option value="6">ุงูุณูุฉ 6</option>
                </select>
            </div>
            <div class="form-group">
                <label>ุงูููุฎุต</label>
                <textarea id="dashboardLessonSummary" placeholder="ุฃุฏุฎู ููุฎุต ุงูุฏุฑุณ" rows="3"></textarea>
            </div>
            <button class="btn btn-success" onclick="addDashboardLesson()" style="width:100%; margin-top:10px;">โ ุฅุถุงูุฉ</button>
        </div>
    </div>

    <!-- ADD VIDEO MODAL -->
    <div id="dashboardAddVideoModal" class="dashboard-modal">
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2>ุฅุถุงูุฉ ููุฏูู</h2>
                <button class="dashboard-close-btn" onclick="closeDashboardModal('dashboardAddVideoModal')">ร</button>
            </div>
            <div class="form-group">
                <label>ุนููุงู ุงูููุฏูู</label>
                <input type="text" id="dashboardVideoTitle" placeholder="ุฃุฏุฎู ุนููุงู ุงูููุฏูู">
            </div>
            <div class="form-group">
                <label>ุงูุฏุฑุณ</label>
                <select id="dashboardVideoLesson"></select>
            </div>
            <div class="form-group">
                <label>ุฑุงุจุท YouTube</label>
                <input type="url" id="dashboardVideoUrl" placeholder="https://youtube.com/...">
            </div>
            <button class="btn btn-success" onclick="addDashboardVideo()" style="width:100%; margin-top:10px;">โ ุฅุถุงูุฉ</button>
        </div>
    </div>

    <!-- ADD EXERCISE MODAL -->
    <div id="dashboardAddExerciseModal" class="dashboard-modal">
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2>ุฅุถุงูุฉ ุชูุฑูู</h2>
                <button class="dashboard-close-btn" onclick="closeDashboardModal('dashboardAddExerciseModal')">ร</button>
            </div>
            <div class="form-group">
                <label>ุงูุณุคุงู</label>
                <textarea id="dashboardExerciseQuestion" placeholder="ุฃุฏุฎู ุงูุณุคุงู" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label>ุงูุฏุฑุณ</label>
                <select id="dashboardExerciseLesson"></select>
            </div>
            <div class="form-group">
                <label>ุงูููุน</label>
                <select id="dashboardExerciseType">
                    <option value="multiple">ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ</option>
                    <option value="blank">ููุก ุงููุฑุงุบ</option>
                    <option value="true-false">ุตุญ/ุฎุทุฃ</option>
                </select>
            </div>
            <button class="btn btn-success" onclick="addDashboardExercise()" style="width:100%; margin-top:10px;">โ ุฅุถุงูุฉ</button>
        </div>
    </div>

    <!-- ADD STUDENT MODAL -->
    <div id="dashboardAddStudentModal" class="dashboard-modal">
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2>ุฅุถุงูุฉ ุทุงูุจ</h2>
                <button class="dashboard-close-btn" onclick="closeDashboardModal('dashboardAddStudentModal')">ร</button>
            </div>
            <div class="form-group">
                <label>ุงุณู ุงูุทุงูุจ</label>
                <input type="text" id="dashboardStudentName" placeholder="ุฃุฏุฎู ุงุณู ุงูุทุงูุจ">
            </div>
            <div class="form-group">
                <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                <input type="email" id="dashboardStudentEmail" placeholder="example@mail.com">
            </div>
            <div class="form-group">
                <label>ุงููุณุชูู</label>
                <select id="dashboardStudentLevel">
                    <option value="3">ุงูุณูุฉ 3</option>
                    <option value="4">ุงูุณูุฉ 4</option>
                    <option value="5">ุงูุณูุฉ 5</option>
                    <option value="6">ุงูุณูุฉ 6</option>
                </select>
            </div>
            <button class="btn btn-success" onclick="addDashboardStudent()" style="width:100%; margin-top:10px;">โ ุฅุถุงูุฉ</button>
        </div>
    </div>

    <!-- ADD SUBSCRIPTION MODAL -->
    <div id="dashboardAddSubscriptionModal" class="dashboard-modal">
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2>ุฅุถุงูุฉ ุฎุทุฉ ุงุดุชุฑุงู</h2>
                <button class="dashboard-close-btn" onclick="closeDashboardModal('dashboardAddSubscriptionModal')">ร</button>
            </div>
            <div class="form-group">
                <label>ุงุณู ุงูุฎุทุฉ</label>
                <input type="text" id="dashboardSubscriptionName" placeholder="ูุซุงู: ุฎุทุฉ ุฃุณุงุณูุฉ">
            </div>
            <div class="form-group">
                <label>ุงูุณุนุฑ (ุฏ.ุช)</label>
                <input type="number" id="dashboardSubscriptionPrice" placeholder="12" min="0" step="0.01">
            </div>
            <div class="form-group">
                <label>ุงููุฏุฉ (ุจุงูุฃูุงู)</label>
                <input type="number" id="dashboardSubscriptionDuration" placeholder="30" min="1">
            </div>
            <button class="btn btn-success" onclick="addDashboardSubscription()" style="width:100%; margin-top:10px;">โ ุฅุถุงูุฉ</button>
        </div>
    </div>

    <!-- SCRIPTS - ุงููุณุงุฑ ุงูุตุญูุญ โ -->
    <script src="../js/dashboard.js"></script>
    <script>
        // ุฏูุงู ุงูุชุจุฏูู ุจูู ุงูุชุจููุจุงุช
        function switchDashboardTab(e, tabName) {
            document.querySelectorAll('.dashboard-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.dashboard-nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            e.target.classList.add('active');
            
            updateDashboardAll();
        }

        // ุชุญุฏูุซ ุฌููุน ุงูุจูุงูุงุช
        function updateDashboardAll() {
            updateDashboardStats();
            updateDashboardSubjects();
            updateDashboardLessons();
            updateDashboardVideos();
            updateDashboardExercises();
            updateDashboardStudents();
            updateDashboardSubscriptions();
            updateDashboardAI();
        }

        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
        function updateDashboardStats() {
            const stats = dashboard.getStats();
            document.getElementById('dashboard-total-subjects').textContent = stats.totalSubjects;
            document.getElementById('dashboard-total-lessons').textContent = stats.totalLessons;
            document.getElementById('dashboard-total-videos').textContent = stats.totalVideos;
            document.getElementById('dashboard-total-exercises').textContent = stats.totalExercises;
            document.getElementById('dashboard-total-students').textContent = stats.totalStudents;
            document.getElementById('dashboard-active-students').textContent = stats.activeStudents;
            document.getElementById('dashboard-avg-performance').textContent = stats.avgPerformance + '%';
            document.getElementById('dashboard-total-revenue').textContent = stats.totalRevenue.toFixed(2) + ' ุฏ.ุช';
        }

        // ุชุญุฏูุซ ุงูููุงุฏ
        function updateDashboardSubjects() {
            let html = dashboard.subjects.map(s => {
                const lessonCount = dashboard.lessons.filter(l => l.subject === s.id).length;
                return `
                    <tr>
                        <td><strong>${s.name}</strong></td>
                        <td>${s.levels.join(', ')}</td>
                        <td>${lessonCount}</td>
                        <td><span class="badge badge-ai">๐ค ููุนูู</span></td>
                    </tr>
                `;
            }).join('');
            document.getElementById('dashboard-subjects-tbody').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูุฏุฑูุณ
        function updateDashboardLessons() {
            if (dashboard.lessons.length === 0) {
                document.getElementById('dashboard-lessons-list').innerHTML = 
                    '<div class="dashboard-empty-state"><div class="dashboard-empty-state-icon">๐</div><p>ูุง ุชูุฌุฏ ุฏุฑูุณ</p></div>';
                return;
            }
            
            let html = dashboard.lessons.map(l => {
                const subject = dashboard.subjects.find(s => s.id === l.subject);
                return `
                    <div class="dashboard-lesson-card">
                        <h4>${l.title}</h4>
                        <div class="dashboard-lesson-card-meta">
                            ๐ ${subject?.name} | ุงูุณูุฉ ${l.level}
                        </div>
                        <button class="btn btn-danger" onclick="deleteDashboardLesson('${l.id}')" style="margin-top:10px;">๐๏ธ ุญุฐู</button>
                    </div>
                `;
            }).join('');
            document.getElementById('dashboard-lessons-list').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูููุฏูููุงุช
        function updateDashboardVideos() {
            if (dashboard.videos.length === 0) {
                document.getElementById('dashboard-videos-tbody').innerHTML = 
                    '<tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ููุฏูููุงุช</td></tr>';
                return;
            }
            
            let html = dashboard.videos.map(v => {
                const lesson = dashboard.lessons.find(l => l.id === v.lessonId);
                return `
                    <tr>
                        <td>${v.title}</td>
                        <td>${lesson?.title || 'N/A'}</td>
                        <td><span class="badge badge-active">ูุชุงุญ</span></td>
                        <td><button class="btn btn-danger" onclick="deleteDashboardVideo('${v.id}')" style="padding:6px 10px; font-size:0.85rem;">ุญุฐู</button></td>
                    </tr>
                `;
            }).join('');
            document.getElementById('dashboard-videos-tbody').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูุชูุงุฑูู
        function updateDashboardExercises() {
            if (dashboard.exercises.length === 0) {
                document.getElementById('dashboard-exercises-tbody').innerHTML = 
                    '<tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ุชูุงุฑูู</td></tr>';
                return;
            }
            
            let html = dashboard.exercises.map(e => {
                return `
                    <tr>
                        <td>${e.question.substring(0, 40)}...</td>
                        <td>ุฏุฑุณ</td>
                        <td>${e.type}</td>
                        <td><button class="btn btn-danger" onclick="deleteDashboardExercise('${e.id}')" style="padding:6px 10px; font-size:0.85rem;">ุญุฐู</button></td>
                    </tr>
                `;
            }).join('');
            document.getElementById('dashboard-exercises-tbody').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูุทูุงุจ
        function updateDashboardStudents() {
            if (dashboard.students.length === 0) {
                document.getElementById('dashboard-students-tbody').innerHTML = 
                    '<tr><td colspan="4" style="text-align:center;color:#999;">ูุง ููุฌุฏ ุทูุงุจ</td></tr>';
                return;
            }
            
            let html = dashboard.students.map(s => {
                return `
                    <tr>
                        <td>${s.name}</td>
                        <td>ุงูุณูุฉ ${s.level}</td>
                        <td>${s.performance}%</td>
                        <td><span class="badge badge-active">ูุดุท</span></td>
                    </tr>
                `;
            }).join('');
            document.getElementById('dashboard-students-tbody').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูุงุดุชุฑุงูุงุช
        function updateDashboardSubscriptions() {
            if (dashboard.subscriptions.length === 0) {
                document.getElementById('dashboard-subscriptions-tbody').innerHTML = 
                    '<tr><td colspan="4" style="text-align:center;color:#999;">ูุง ุชูุฌุฏ ุฎุทุท</td></tr>';
                return;
            }
            
            let html = dashboard.subscriptions.map(s => {
                return `
                    <tr>
                        <td><strong>${s.name}</strong></td>
                        <td>${s.price} ุฏ.ุช</td>
                        <td>${s.duration} ููู</td>
                        <td><span class="badge badge-active">ููุนู</span></td>
                    </tr>
                `;
            }).join('');
            document.getElementById('dashboard-subscriptions-tbody').innerHTML = html;
        }

        // ุชุญุฏูุซ ุงูุฑุคู ุงูุฐููุฉ
        function updateDashboardAI() {
            const insights = dashboard.generateAIInsights();
            let html = insights.map(i => {
                return `
                    <div class="dashboard-lesson-card">
                        <h4>${i.icon} ${i.type}</h4>
                        <p>${i.message}</p>
                    </div>
                `;
            }).join('');
            document.getElementById('dashboard-ai-content').innerHTML = html;
        }

        // ุฏูุงู ุงูุฅุถุงูุฉ
        function openDashboardAddLessonModal() {
            const select = document.getElementById('dashboardLessonSubject');
            select.innerHTML = dashboard.subjects.map(s => `<option value="${s.id}">${s.name}</option>`).join('');
            document.getElementById('dashboardAddLessonModal').classList.add('active');
        }

        function addDashboardLesson() {
            const title = document.getElementById('dashboardLessonTitle').value;
            const subject = document.getElementById('dashboardLessonSubject').value;
            const level = document.getElementById('dashboardLessonLevel').value;
            const summary = document.getElementById('dashboardLessonSummary').value;
            
            const result = dashboard.addLesson(title, subject, level, summary, true);
            if (result.success) {
                alert('โ ' + result.message);
                document.getElementById('dashboardAddLessonModal').classList.remove('active');
                document.getElementById('dashboardLessonTitle').value = '';
                updateDashboardAll();
            }
        }

        function deleteDashboardLesson(id) {
            if (confirm('ูู ุชุฑูุฏ ุญุฐู ูุฐุง ุงูุฏุฑุณุ')) {
                dashboard.deleteLesson(id);
                updateDashboardAll();
            }
        }

        function openDashboardAddVideoModal() {
            const select = document.getElementById('dashboardVideoLesson');
            select.innerHTML = dashboard.lessons.map(l => `<option value="${l.id}">${l.title}</option>`).join('');
            if (dashboard.lessons.length === 0) select.innerHTML = '<option>ูุง ุชูุฌุฏ ุฏุฑูุณ</option>';
            document.getElementById('dashboardAddVideoModal').classList.add('active');
        }

        function addDashboardVideo() {
            const title = document.getElementById('dashboardVideoTitle').value;
            const lessonId = document.getElementById('dashboardVideoLesson').value;
            const url = document.getElementById('dashboardVideoUrl').value;
            
            const result = dashboard.addVideo(title, lessonId, url, 10);
            if (result.success) {
                alert('โ ' + result.message);
                document.getElementById('dashboardAddVideoModal').classList.remove('active');
                document.getElementById('dashboardVideoTitle').value = '';
                updateDashboardAll();
            }
        }

        function deleteDashboardVideo(id) {
            if (confirm('ูู ุชุฑูุฏ ุญุฐู ูุฐุง ุงูููุฏููุ')) {
                dashboard.deleteVideo(id);
                updateDashboardAll();
            }
        }

        function openDashboardAddExerciseModal() {
            const select = document.getElementById('dashboardExerciseLesson');
            select.innerHTML = dashboard.lessons.map(l => `<option value="${l.id}">${l.title}</option>`).join('');
            if (dashboard.lessons.length === 0) select.innerHTML = '<option>ูุง ุชูุฌุฏ ุฏุฑูุณ</option>';
            document.getElementById('dashboardAddExerciseModal').classList.add('active');
        }

        function addDashboardExercise() {
            const question = document.getElementById('dashboardExerciseQuestion').value;
            const lessonId = document.getElementById('dashboardExerciseLesson').value;
            const type = document.getElementById('dashboardExerciseType').value;
            
            const result = dashboard.addExercise(question, lessonId, type, 'ุฅุฌุงุจุฉ', true);
            if (result.success) {
                alert('โ ' + result.message);
                document.getElementById('dashboardAddExerciseModal').classList.remove('active');
                document.getElementById('dashboardExerciseQuestion').value = '';
                updateDashboardAll();
            }
        }

        function deleteDashboardExercise(id) {
            if (confirm('ูู ุชุฑูุฏ ุญุฐู ูุฐุง ุงูุชูุฑููุ')) {
                dashboard.deleteExercise(id);
                updateDashboardAll();
            }
        }

        function openDashboardAddStudentModal() {
            document.getElementById('dashboardAddStudentModal').classList.add('active');
        }

        function addDashboardStudent() {
            const name = document.getElementById('dashboardStudentName').value;
            const email = document.getElementById('dashboardStudentEmail').value;
            const level = document.getElementById('dashboardStudentLevel').value;
            
            const result = dashboard.addStudent(name, email, level);
            if (result.success) {
                alert('โ ' + result.message);
                document.getElementById('dashboardAddStudentModal').classList.remove('active');
                document.getElementById('dashboardStudentName').value = '';
                updateDashboardAll();
            }
        }

        function openDashboardAddSubscriptionModal() {
            document.getElementById('dashboardAddSubscriptionModal').classList.add('active');
        }

        function addDashboardSubscription() {
            const name = document.getElementById('dashboardSubscriptionName').value;
            const price = document.getElementById('dashboardSubscriptionPrice').value;
            const duration = document.getElementById('dashboardSubscriptionDuration').value;
            
            const result = dashboard.addSubscription(name, price, duration, 'ููุฒุฉ 1\nููุฒุฉ 2');
            if (result.success) {
                alert('โ ' + result.message);
                document.getElementById('dashboardAddSubscriptionModal').classList.remove('active');
                document.getElementById('dashboardSubscriptionName').value = '';
                updateDashboardAll();
            }
        }

        function closeDashboardModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function downloadDashboardReport() {
            const stats = dashboard.getStats();
            const report = `ุชูุฑูุฑ ููุญุฉ ุงูุชุญูู - ${new Date().toLocaleString('ar-TN')}
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ุงูุฅุญุตุงุฆูุงุช:
- ุงูููุงุฏ: ${stats.totalSubjects}
- ุงูุฏุฑูุณ: ${stats.totalLessons}
- ุงูููุฏูููุงุช: ${stats.totalVideos}
- ุงูุชูุงุฑูู: ${stats.totalExercises}
- ุงูุทูุงุจ: ${stats.totalStudents}
- ุงูุฅูุฑุงุฏุงุช: ${stats.totalRevenue.toFixed(2)} ุฏ.ุช
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ`;
            
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dashboard-report-' + Date.now() + '.txt';
            a.click();
        }

        // ุงูุชููุฆุฉ
        document.addEventListener('DOMContentLoaded', () => {
            updateDashboardAll();
        });

        // ุชุญุฏูุซ ุชููุงุฆู
        setInterval(updateDashboardAll, 30000);
    </script>
</body>
</html>
